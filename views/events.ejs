<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Events | Eventify</title>
    <link rel="stylesheet" href="/home.css">
    <link rel="stylesheet" href="/events.css">
</head>
<body>

    <%- include('partials/header') %>

    <main class="events-page-main">
        <div class="container">
            <section class="page-header">
                <h1>Explore All Events</h1>
                <p>Find concerts, workshops, comedy shows, and more happening near you.</p>
                <% if (user && user.usertype === 'creator') { %>
                    <div style="margin-top: 1rem;">
                        <a href="/events/my-events" class="btn btn-primary" style="margin-right: 1rem;">My Events</a>
                        <a href="/events/create" class="btn btn-secondary">Create New Event</a>
                    </div>
                <% } %>
            </section>

            <section class="filter-controls">
                <!-- ഫോമിൽ action, method എന്നിവ ചേർത്തു -->
                <form class="filter-form" action="/events" method="GET">
                    <input type="search" name="search" placeholder="Search by event or artist..." value="<%= query.search || '' %>">
                    
                    <select name="category">
                        <option value="">All Categories</option>
                        <!-- തിരഞ്ഞെടുത്ത ഓപ്ഷൻ നിലനിർത്തുന്നു -->
                        <option value="Music" <%= (query.category === 'Music') ? 'selected' : '' %>>Music</option>
                        <option value="Comedy" <%= (query.category === 'Comedy') ? 'selected' : '' %>>Comedy</option>
                        <option value="Workshop" <%= (query.category === 'Workshop') ? 'selected' : '' %>>Workshop</option>
                        <option value="Rap" <%= (query.category === 'Rap') ? 'selected' : '' %>>Rap</option>
                    </select>
                    
                    <select name="location">
                        <option value="">All Locations</option>
                        <option value="Calicut" <%= (query.location === 'Calicut') ? 'selected' : '' %>>Calicut</option>
                        <option value="Kochi" <%= (query.location === 'Kochi') ? 'selected' : '' %>>Kochi</option>
                        <option value="Trivandrum" <%= (query.location === 'Trivandrum') ? 'selected' : '' %>>Trivandrum</option>
                    </select>
                    
                    <button type="submit" class="btn btn-primary">Apply Filters</button>
                </form>
            </section>

            <section class="all-events-section">
                <div class="event-grid">
                    <% if (events && events.length > 0) { %>
                        <% events.forEach(event => { %>
                            <article class="event-card">
                                <img class="event-image" src="<%= event.image %>" alt="<%= event.title %> Poster">
                                <div class="event-details">
                                    <h3 class="card-title"><%= event.title %></h3>
                                    <p class="card-location"><%= event.date %></p>
                                    <p class="card-price">₹<%= event.price %></p>
                                    <a href="/events/<%= event._id %>" class="btn btn-secondary">View details</a>
                                </div>
                            </article>
                        <% }) %>
                    <% } else { %>
                        <p class="no-events-message">No events found matching your criteria. Please try different filters.</p>
                    <% } %>
                </div>
            </section>
        </div>
    </main>

    <%- include('partials/footer') %>

</body>
</html>
